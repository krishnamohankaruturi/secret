<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.ku.cete.model.TestCutScoresMapper">
  <resultMap id="BaseResultMap" type="edu.ku.cete.domain.report.TestCutScores">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="schoolyear" jdbcType="BIGINT" property="schoolYear" />
    <result column="assessmentprogramid" jdbcType="BIGINT" property="assessmentProgramId" />
    <result column="subjectid" jdbcType="BIGINT" property="subjectId" />
    <result column="gradeid" jdbcType="BIGINT" property="gradeId" />
    <result column="level" jdbcType="BIGINT" property="level" />
    <result column="batchuploadid" jdbcType="BIGINT" property="batchUploadId" />
    <result column="createddate" jdbcType="TIMESTAMP" property="createdDate" />
    <result column="createduser" jdbcType="BIGINT" property="createduser" />
    <result column="activeflag" jdbcType="BIT" property="activeFlag" />
    <result column="levellowcutscore" jdbcType="BIGINT" property="levelLowCutScore" />
    <result column="levelhighcutscore" jdbcType="BIGINT" property="levelHighCutScore" />
    <result column="levelid" jdbcType="BIGINT" property="levelId" />
    <result column="domain" jdbcType="VARCHAR" property="domain" />
    <result column="levelname" jdbcType="VARCHAR" property="levelName" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    id, schoolyear, assessmentprogramid, subjectid, gradeid, level, 
    batchuploadid, createddate, createduser, activeflag, levellowcutscore, levelhighcutscore, 
    levelid, domain
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from testcutscores
    where id = #{id,jdbcType=BIGINT}
  </select>
  <insert id="insert" parameterType="edu.ku.cete.domain.report.TestCutScores">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.Long">
      SELECT nextval('testcutscores_id_seq')
    </selectKey>
    insert into testcutscores (id, schoolyear, assessmentprogramid, 
      subjectid, gradeid, level, batchuploadid, 
      createddate, createduser, activeflag, 
      levellowcutscore, levelhighcutscore, levelid, domain
      )
    values (#{id,jdbcType=BIGINT}, #{schoolYear,jdbcType=BIGINT}, #{assessmentProgramId,jdbcType=BIGINT}, 
      #{subjectId,jdbcType=BIGINT}, #{gradeId,jdbcType=BIGINT}, #{level,jdbcType=BIGINT}, #{batchUploadId,jdbcType=BIGINT}, 
      #{createdDate,jdbcType=TIMESTAMP}, #{createduser,jdbcType=BIGINT}, #{activeFlag,jdbcType=BIT}, 
      #{levelLowCutScore,jdbcType=BIGINT}, #{levelHighCutScore,jdbcType=BIGINT}, #{levelId,jdbcType=BIGINT}, #{domain,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="edu.ku.cete.domain.report.TestCutScores">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.Long">
      SELECT nextval('testcutscores_id_seq')
    </selectKey>
    insert into testcutscores
    <trim prefix="(" suffix=")" suffixOverrides=",">
      id,
      <if test="schoolYear != null">
        schoolyear,
      </if>
      <if test="assessmentProgramId != null">
        assessmentprogramid,
      </if>
      <if test="subjectId != null">
        subjectid,
      </if>
      <if test="gradeId != null">
        gradeid,
      </if>
      <if test="level != null">
        level,
      </if>
      <if test="batchUploadId != null">
        batchuploadid,
      </if>
      <if test="createdDate != null">
        createddate,
      </if>
      <if test="createduser != null">
        createduser,
      </if>
      <if test="activeFlag != null">
        activeflag,
      </if>
      <if test="levelLowCutScore != null">
        levellowcutscore,
      </if>
      <if test="levelHighCutScore != null">
        levelhighcutscore,
      </if>
      <if test="levelId != null">
        levelid,
      </if>
      <if test="domain != null">
        domain,
      </if>
      <if test="testingProgramId != null">
        testingprogramid,
      </if>
      <if test="reportCycle != null">
        reportcycle,
      </if>
      <if test="testType != null">
        assessmentcode,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      #{id,jdbcType=BIGINT},
      <if test="schoolYear != null">
        #{schoolYear,jdbcType=BIGINT},
      </if>
      <if test="assessmentProgramId != null">
        #{assessmentProgramId,jdbcType=BIGINT},
      </if>
      <if test="subjectId != null">
        #{subjectId,jdbcType=BIGINT},
      </if>
      <if test="gradeId != null">
        #{gradeId,jdbcType=BIGINT},
      </if>
      <if test="level != null">
        #{level,jdbcType=BIGINT},
      </if>
      <if test="batchUploadId != null">
        #{batchUploadId,jdbcType=BIGINT},
      </if>
      <if test="createdDate != null">
        #{createdDate,jdbcType=TIMESTAMP},
      </if>
      <if test="createduser != null">
        #{createduser,jdbcType=BIGINT},
      </if>
      <if test="activeFlag != null">
        #{activeFlag,jdbcType=BIT},
      </if>
      <if test="levelLowCutScore != null">
        #{levelLowCutScore,jdbcType=BIGINT},
      </if>
      <if test="levelHighCutScore != null">
        #{levelHighCutScore,jdbcType=BIGINT},
      </if>
      <if test="levelId != null">
        #{levelId,jdbcType=BIGINT},
      </if>
      <if test="domain != null">
        #{domain,jdbcType=VARCHAR},
      </if>
      <if test="testingProgramId != null">
         #{testingProgramId,jdbcType=BIGINT},
      </if>
      <if test="reportCycle != null">
        #{reportCycle,jdbcType=VARCHAR},
      </if>
      <if test="testType != null">
        #{testType,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="edu.ku.cete.domain.report.TestCutScores">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    update testcutscores
    <set>
      <if test="schoolYear != null">
        schoolyear = #{schoolYear,jdbcType=BIGINT},
      </if>
      <if test="assessmentProgramId != null">
        assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT},
      </if>
      <if test="subjectId != null">
        subjectid = #{subjectId,jdbcType=BIGINT},
      </if>
      <if test="gradeId != null">
        gradeid = #{gradeId,jdbcType=BIGINT},
      </if>
      <if test="level != null">
        level = #{level,jdbcType=BIGINT},
      </if>
      <if test="batchUploadId != null">
        batchuploadid = #{batchUploadId,jdbcType=BIGINT},
      </if>
      <if test="createdDate != null">
        createddate = #{createdDate,jdbcType=TIMESTAMP},
      </if>
      <if test="createduser != null">
        createduser = #{createduser,jdbcType=BIGINT},
      </if>
      <if test="activeFlag != null">
        activeflag = #{activeFlag,jdbcType=BIT},
      </if>
      <if test="levelLowCutScore != null">
        levellowcutscore = #{levelLowCutScore,jdbcType=BIGINT},
      </if>
      <if test="levelHighCutScore != null">
        levelhighcutscore = #{levelHighCutScore,jdbcType=BIGINT},
      </if>
      <if test="levelId != null">
        levelid = #{levelId,jdbcType=BIGINT},
      </if>
      <if test="domain != null">
        domain = #{domain,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="edu.ku.cete.domain.report.TestCutScores">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 19 07:53:23 CDT 2015.
    -->
    update testcutscores
    set schoolyear = #{schoolYear,jdbcType=BIGINT},
      assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT},
      subjectid = #{subjectId,jdbcType=BIGINT},
      gradeid = #{gradeId,jdbcType=BIGINT},
      level = #{level,jdbcType=BIGINT},
      batchuploadid = #{batchUploadId,jdbcType=BIGINT},
      createddate = #{createdDate,jdbcType=TIMESTAMP},
      createduser = #{createduser,jdbcType=BIGINT},
      activeflag = #{activeFlag,jdbcType=BIT},
      levellowcutscore = #{levelLowCutScore,jdbcType=BIGINT},
      levelhighcutscore = #{levelHighCutScore,jdbcType=BIGINT},
      levelid = #{levelId,jdbcType=BIGINT},
      domain = #{domain,jdbcType=VARCHAR}
    where id = #{id,jdbcType=BIGINT}
  </update>
  
  <delete id="deleteAll">
    delete from testcutscores 
    <if test="schoolYear != null">
    	where schoolyear = #{schoolYear,jdbcType=BIGINT}
     </if>
  </delete>
  
  <delete id="deleteTestCutScores">
    delete from testcutscores
    where assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT} 
    and subjectid = #{subjectId,jdbcType=BIGINT} 
    and  schoolyear = #{schoolYear,jdbcType=BIGINT}
    <if test="testingProgramId != null">
    	and testingprogramid = #{testingProgramId,jdbcType=BIGINT}
    </if>
    <if test="reportCycle != null">
    	and reportcycle = #{reportCycle,jdbcType=VARCHAR}
    </if>
  </delete>
  
   <select id="checkDuplicateTestIdsWithLevel" resultMap="BaseResultMap">
   	select  <include refid="Base_Column_List" />
   	 from testcutscores 
   	 where level = #{level,jdbcType=BIGINT} 
   	 and assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT} and subjectid = #{subjectId,jdbcType=BIGINT} and gradeid = #{gradeId,jdbcType=BIGINT}
   	<if test="schoolYear != null">
    	and schoolyear = #{schoolYear,jdbcType=BIGINT}
    </if>
    <if test="domain != null">
    	and domain = #{domain,jdbcType=VARCHAR}
    </if>
    <if test="testingProgramId != null">
    	and testingprogramid = #{testingProgramId,jdbcType=BIGINT}
    </if>
    <if test="reportCycle != null">
    	and reportcycle = #{reportCycle,jdbcType=VARCHAR}
    </if>
    limit 1
  </select>
  
  
  <select id="getCutScoresBasedOnAssessmentProgramSubjectYear" resultMap="BaseResultMap">
   select * from testcutscores
   	where assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT} and subjectid = #{subjectId,jdbcType=BIGINT}
	    <if test="gradeCourseId != null">
	    	and gradeid = #{gradeCourseId, jdbcType=BIGINT}
	    </if>
	   <if test="schoolYear != null">
	   		and schoolyear = #{schoolYear,jdbcType=BIGINT}
	   </if>
	   <if test="testingProgramId != null">
    		and testingprogramid = #{testingProgramId,jdbcType=BIGINT}
	   </if>
  </select>
 
   <select id="getInterimCutScoresBasedOnAssessmentProgramSubjectYear" resultMap="BaseResultMap">
   select * from testcutscores
   	where assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT} 
   	and subjectid = #{contentAreaId,jdbcType=BIGINT}
	and gradeid = #{gradeId, jdbcType=BIGINT}
	and schoolyear = #{schoolYear,jdbcType=BIGINT}
	and reportcycle = #{reportCycle,jdbcType=BIGINT}
	and testingprogramid = #{testingProgramId,jdbcType=BIGINT}
	and activeflag is true
	order by level
  </select>  
  
   <select id="getExternalStudentReportTestCutScores" resultMap="BaseResultMap">
  	select tc.levellowcutscore,tc.levelhighcutscore,tc.level,ld.levelname from testcutscores tc 
	 inner join leveldescription ld on ld.level = tc.level 
	 and ld.activeflag is true 
	 and ld.schoolyear = tc.schoolyear 
	 and ld.assessmentprogramid = tc.assessmentprogramid
	 and ld.reportcycle = tc.reportcycle
	 and ld.assessmentcode = tc.assessmentcode
	 and ld.testingprogramid = tc.testingprogramid
	where tc.assessmentprogramid = #{assessmentProgramId,jdbcType=BIGINT} 
	<if test="contentAreaId != null">
        and tc.subjectid = #{contentAreaId,jdbcType=BIGINT}
    </if>	
	<if test="gradeId != null">
		and tc.gradeid = #{gradeId, jdbcType=BIGINT}
	</if>
	and tc.schoolyear = #{schoolYear,jdbcType=BIGINT}
	and tc.reportcycle = #{reportCycle,jdbcType=VARCHAR} 
	and tc.testingprogramid = #{testingProgramId,jdbcType=BIGINT}
	and tc.assessmentcode = #{assessmentCode,jdbcType=VARCHAR}
	and tc.activeflag is true 
	order by tc.level
   </select>
  
</mapper>