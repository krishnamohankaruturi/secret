--US17280 - Utah Restoring Confirmed and Saved ITI Test plans not showing because of EXIT
update testsession set activeflag = true, 
status = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='unused' AND ct.typecode = 'STUDENT_TEST_STATUS'),
modifieddate = now(), modifieduser = (select id from aartuser where username = 'cetesysadmin')
    where id in (select st.testsessionid from student stu join enrollment en on en.studentid = stu.id join studentstests st on st.enrollmentid = en.id join testsession ts on ts.id = st.testsessionid 
         where stu.statestudentidentifier in ('1683280','1782824','1935077','1925435','1925873','1925987','1926954','1929853','1930844','1932904','1935310','1937178','1938686','1942303','1942680','1948127','1951360','1953809','1957225','1957234','1965186','1976959','1977956','1988814','1988815','1989196','1995369','1998840','1999130','2002260','2003475','2005513','2007423','2012830','2014040','2015112','2015927','2017887','2021747','2037026','2040087','2041004','2044223','2058156','2072449','2074829','2077328','2080995','2083023','2085620','2085800','2088225','2134858','2150254','2153867','2156929','2159677','2160692','2161621','2191660','2200568','2233950','2244928','2246998','2250874','2256760','2261632','2262986','2263047','2264524','2264568','2277890','2285305','2296628','2300786','2300988','2304073','2304883','1683280','1629771','1629771','1630930','1630930','1709408','1709408','1770870','1770870','1771015','1771015','1784318','1784318','1844042','1844042','1844049','1844049','1853201','1853201','1853993','1853993','1857812','1857812','1860192','1860192','1898235','1898235','1909919','1909919','1928048','1928048','1935590','1935590','1962811','1962811','1975170','1975170','2005023','2005023','2033621','2033621','2081065','2081065','2217290','2217290','2235226','2235226','1783004','1783147','1783176','1783246','1783361','1783471','1783744','1784247','1784731','1784838','1784849','1784875','1785027','1785110','1785224','1786087','1786459','1787277','1787360','1788221','1788771','1788935','1789021','1790271','1792600','1794903','1795513','1796114','1796644','1803331','1803883','1811221','1825630','1833997','1834154','1841753','1842934','1845689','1846100','1849342','1849343','1849366','1849550','1849950','1850787','1850934','1851698','1852000','1852086','1852138','1852329','1852351','1852396','1852459','1852512','1852535','1852626','1853062','1853101','1854087','1856668','1856811','1856839','1857740','1857784','1858577','1858591','1858613','1858684','1859179','1860643','1860951','1860978','1860992','1863535','1863839','1874745','1878903','1884907','1886047','1890924','1895668','1895753','1896721','1897068','1905820','1912496','1915595','1916771','1918073','1014021','1015642','1020150','1021024','1024791','1026478','1027402','1027442','1031250','1032367','1032375','1032379','1032412','1032414','1037305','1037321','1037343','1037345','1037365','1039733','1039761','1039764','1039772','1040524','1042966','1044975','1046045','1046870','1049280','1049375','1050613','1089863','1089866','1089871','1089903','1089937','1089944','1089972','1090017','1090024','1090068','1090100','1090108','1090126','1090129','1090143','1090151','1090172','1090180','1090197','1090213','1090259','1090275','1090306','1090308','1090309','1090520','1090540','1090577','1090592','1090604','1090616','1090623','1090639','1090674','1090688','1090693','1090705','1090708','1103767','1110784','1119489','1229661','1233013','1242601','1261807','1274239','1284280','1327774','1328519','1328712','1329029','1329046','1329151','1329520','1329523','1329534','1338857','1355840','1365100','1365243','1365642','1365695','1366585','1366910','1388612','1392460','1403524','1403976','1407495','1407547','1465708','1465800','1465851','1466188','1466275','1466721','1466722','1469388','1470523','1470968','1471317','1472197','1472309','1472445','1476604','1477031','1477424','1523452','1526440','1526469','1526488','1526505','1526506','1526510','1526511','1526527','1526534','1530095','1534418','1537835','1539667','1539710','1539713','1539717','1539723','1539765','1539809','1540528','1540546','1540614','1540621','1541015','1541275','1541309','1541648','1541673','1541835','1541894','1542765','1543484','1544174','1544798','1544838','1545219','1545436','1546971','1547898','1547916','1548018','1548269','1550356','1550734','1557344','1557585','1557633','1559959','1559966','1559994','1560006','1560019','1565290','1565852','1566346','1575301','1579376','1579515','1579733','1579734','1580052','1581147','1581378','1604621','1608318','1608320','1611448','1612083','1612088','1613106','1613921','1617892','1618024','1618079','1618972','1618993','1620087','1620189','1620247','1620699','1621132','1622834','1622849','1623263','1623473','1623782','1623908','1625691','1625843','1626213','1627464','1627514','1628103','1628701','1629242','1630028','1631315','1631475','1631897','1631929','1632439','1632440','1633659','1637738','1646339','1646536','1651792','1652402','1652420','1652436','1653939','1653959','1654832','1654940','1661756','1662002','1669787','1670414','1670448','1670504','1671334','1671336','1671708','1671710','1671711','1672566','1672578','1672580','1676606','1677959','1680953','1682843','1685693','1686624','1692014','1692063','1694237','1694458','1694469','1694950','1695408','1696711','1696723','1697648','1699310','1701345','1702310','1702446','1702713','1702813','1703187','1703333','1703432','1703459','1703918','1704167','1704498','1704771','1705189','1705315','1705706','1705749','1706282','1707126','1707132','1708038','1708364','1709265','1709388','1709389','1713138','1719067','1721987','1722480','1722877','1727091','1727228','1727375','1727377','1727940','1728129','1747209','1747217','1747858','1750782','1753755','1756437','1756661','1756735','1760349','1767078','1767406','1767442','1767904','1768084','1772515','1772601','1773238','1773444','1773448','1773515','1773518','1773629','1773748','1774326','1774743','1775056','1775651','1778040','1778148','1778912','1779135','1779799','1780010','1780021','1780235','1780692','1780702','1781216','1781392','1781676','1781680','1781730','1782014','1782315','1782585','1782617','1782678')         
         and stu.stateid = 36560 and en.activeflag is true and en.currentschoolyear = 2016 and ts.source = 'ITI' and st.status = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='exitclearunenrolled' AND ct.typecode = 'STUDENT_TEST_STATUS') and st.activeflag is false);
--Update Count: 1590

update studentstestsections set activeflag = true, 
statusid = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='unused' AND ct.typecode = 'STUDENT_TESTSECTION_STATUS'),
modifieddate = now(), modifieduser = (select id from aartuser where username = 'cetesysadmin')
, startdatetime = null , enddatetime = null
    where studentstestid in (select st.id from student stu join enrollment en on en.studentid = stu.id join studentstests st on st.enrollmentid = en.id join testsession ts on ts.id = st.testsessionid 
         where statestudentidentifier in ('1683280','1782824','1935077','1925435','1925873','1925987','1926954','1929853','1930844','1932904','1935310','1937178','1938686','1942303','1942680','1948127','1951360','1953809','1957225','1957234','1965186','1976959','1977956','1988814','1988815','1989196','1995369','1998840','1999130','2002260','2003475','2005513','2007423','2012830','2014040','2015112','2015927','2017887','2021747','2037026','2040087','2041004','2044223','2058156','2072449','2074829','2077328','2080995','2083023','2085620','2085800','2088225','2134858','2150254','2153867','2156929','2159677','2160692','2161621','2191660','2200568','2233950','2244928','2246998','2250874','2256760','2261632','2262986','2263047','2264524','2264568','2277890','2285305','2296628','2300786','2300988','2304073','2304883','1683280','1629771','1629771','1630930','1630930','1709408','1709408','1770870','1770870','1771015','1771015','1784318','1784318','1844042','1844042','1844049','1844049','1853201','1853201','1853993','1853993','1857812','1857812','1860192','1860192','1898235','1898235','1909919','1909919','1928048','1928048','1935590','1935590','1962811','1962811','1975170','1975170','2005023','2005023','2033621','2033621','2081065','2081065','2217290','2217290','2235226','2235226','1783004','1783147','1783176','1783246','1783361','1783471','1783744','1784247','1784731','1784838','1784849','1784875','1785027','1785110','1785224','1786087','1786459','1787277','1787360','1788221','1788771','1788935','1789021','1790271','1792600','1794903','1795513','1796114','1796644','1803331','1803883','1811221','1825630','1833997','1834154','1841753','1842934','1845689','1846100','1849342','1849343','1849366','1849550','1849950','1850787','1850934','1851698','1852000','1852086','1852138','1852329','1852351','1852396','1852459','1852512','1852535','1852626','1853062','1853101','1854087','1856668','1856811','1856839','1857740','1857784','1858577','1858591','1858613','1858684','1859179','1860643','1860951','1860978','1860992','1863535','1863839','1874745','1878903','1884907','1886047','1890924','1895668','1895753','1896721','1897068','1905820','1912496','1915595','1916771','1918073','1014021','1015642','1020150','1021024','1024791','1026478','1027402','1027442','1031250','1032367','1032375','1032379','1032412','1032414','1037305','1037321','1037343','1037345','1037365','1039733','1039761','1039764','1039772','1040524','1042966','1044975','1046045','1046870','1049280','1049375','1050613','1089863','1089866','1089871','1089903','1089937','1089944','1089972','1090017','1090024','1090068','1090100','1090108','1090126','1090129','1090143','1090151','1090172','1090180','1090197','1090213','1090259','1090275','1090306','1090308','1090309','1090520','1090540','1090577','1090592','1090604','1090616','1090623','1090639','1090674','1090688','1090693','1090705','1090708','1103767','1110784','1119489','1229661','1233013','1242601','1261807','1274239','1284280','1327774','1328519','1328712','1329029','1329046','1329151','1329520','1329523','1329534','1338857','1355840','1365100','1365243','1365642','1365695','1366585','1366910','1388612','1392460','1403524','1403976','1407495','1407547','1465708','1465800','1465851','1466188','1466275','1466721','1466722','1469388','1470523','1470968','1471317','1472197','1472309','1472445','1476604','1477031','1477424','1523452','1526440','1526469','1526488','1526505','1526506','1526510','1526511','1526527','1526534','1530095','1534418','1537835','1539667','1539710','1539713','1539717','1539723','1539765','1539809','1540528','1540546','1540614','1540621','1541015','1541275','1541309','1541648','1541673','1541835','1541894','1542765','1543484','1544174','1544798','1544838','1545219','1545436','1546971','1547898','1547916','1548018','1548269','1550356','1550734','1557344','1557585','1557633','1559959','1559966','1559994','1560006','1560019','1565290','1565852','1566346','1575301','1579376','1579515','1579733','1579734','1580052','1581147','1581378','1604621','1608318','1608320','1611448','1612083','1612088','1613106','1613921','1617892','1618024','1618079','1618972','1618993','1620087','1620189','1620247','1620699','1621132','1622834','1622849','1623263','1623473','1623782','1623908','1625691','1625843','1626213','1627464','1627514','1628103','1628701','1629242','1630028','1631315','1631475','1631897','1631929','1632439','1632440','1633659','1637738','1646339','1646536','1651792','1652402','1652420','1652436','1653939','1653959','1654832','1654940','1661756','1662002','1669787','1670414','1670448','1670504','1671334','1671336','1671708','1671710','1671711','1672566','1672578','1672580','1676606','1677959','1680953','1682843','1685693','1686624','1692014','1692063','1694237','1694458','1694469','1694950','1695408','1696711','1696723','1697648','1699310','1701345','1702310','1702446','1702713','1702813','1703187','1703333','1703432','1703459','1703918','1704167','1704498','1704771','1705189','1705315','1705706','1705749','1706282','1707126','1707132','1708038','1708364','1709265','1709388','1709389','1713138','1719067','1721987','1722480','1722877','1727091','1727228','1727375','1727377','1727940','1728129','1747209','1747217','1747858','1750782','1753755','1756437','1756661','1756735','1760349','1767078','1767406','1767442','1767904','1768084','1772515','1772601','1773238','1773444','1773448','1773515','1773518','1773629','1773748','1774326','1774743','1775056','1775651','1778040','1778148','1778912','1779135','1779799','1780010','1780021','1780235','1780692','1780702','1781216','1781392','1781676','1781680','1781730','1782014','1782315','1782585','1782617','1782678')
         and stu.stateid = 36560 and en.activeflag is true and en.currentschoolyear = 2016 and ts.source = 'ITI' and st.status = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='exitclearunenrolled' AND ct.typecode = 'STUDENT_TEST_STATUS') and st.activeflag is false);
--update count: Count: 1590

update studentstests set activeflag = true, 
status = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='unused' AND ct.typecode = 'STUDENT_TEST_STATUS'),
modifieddate = now(), modifieduser = (select id from aartuser where username = 'cetesysadmin')
,startdatetime = null, enddatetime = null
    where id in (select st.id from student stu join enrollment en on en.studentid = stu.id join studentstests st on st.enrollmentid = en.id join testsession ts on ts.id = st.testsessionid 
         where stu.statestudentidentifier in ('1683280','1782824','1935077','1925435','1925873','1925987','1926954','1929853','1930844','1932904','1935310','1937178','1938686','1942303','1942680','1948127','1951360','1953809','1957225','1957234','1965186','1976959','1977956','1988814','1988815','1989196','1995369','1998840','1999130','2002260','2003475','2005513','2007423','2012830','2014040','2015112','2015927','2017887','2021747','2037026','2040087','2041004','2044223','2058156','2072449','2074829','2077328','2080995','2083023','2085620','2085800','2088225','2134858','2150254','2153867','2156929','2159677','2160692','2161621','2191660','2200568','2233950','2244928','2246998','2250874','2256760','2261632','2262986','2263047','2264524','2264568','2277890','2285305','2296628','2300786','2300988','2304073','2304883','1683280','1629771','1629771','1630930','1630930','1709408','1709408','1770870','1770870','1771015','1771015','1784318','1784318','1844042','1844042','1844049','1844049','1853201','1853201','1853993','1853993','1857812','1857812','1860192','1860192','1898235','1898235','1909919','1909919','1928048','1928048','1935590','1935590','1962811','1962811','1975170','1975170','2005023','2005023','2033621','2033621','2081065','2081065','2217290','2217290','2235226','2235226','1783004','1783147','1783176','1783246','1783361','1783471','1783744','1784247','1784731','1784838','1784849','1784875','1785027','1785110','1785224','1786087','1786459','1787277','1787360','1788221','1788771','1788935','1789021','1790271','1792600','1794903','1795513','1796114','1796644','1803331','1803883','1811221','1825630','1833997','1834154','1841753','1842934','1845689','1846100','1849342','1849343','1849366','1849550','1849950','1850787','1850934','1851698','1852000','1852086','1852138','1852329','1852351','1852396','1852459','1852512','1852535','1852626','1853062','1853101','1854087','1856668','1856811','1856839','1857740','1857784','1858577','1858591','1858613','1858684','1859179','1860643','1860951','1860978','1860992','1863535','1863839','1874745','1878903','1884907','1886047','1890924','1895668','1895753','1896721','1897068','1905820','1912496','1915595','1916771','1918073','1014021','1015642','1020150','1021024','1024791','1026478','1027402','1027442','1031250','1032367','1032375','1032379','1032412','1032414','1037305','1037321','1037343','1037345','1037365','1039733','1039761','1039764','1039772','1040524','1042966','1044975','1046045','1046870','1049280','1049375','1050613','1089863','1089866','1089871','1089903','1089937','1089944','1089972','1090017','1090024','1090068','1090100','1090108','1090126','1090129','1090143','1090151','1090172','1090180','1090197','1090213','1090259','1090275','1090306','1090308','1090309','1090520','1090540','1090577','1090592','1090604','1090616','1090623','1090639','1090674','1090688','1090693','1090705','1090708','1103767','1110784','1119489','1229661','1233013','1242601','1261807','1274239','1284280','1327774','1328519','1328712','1329029','1329046','1329151','1329520','1329523','1329534','1338857','1355840','1365100','1365243','1365642','1365695','1366585','1366910','1388612','1392460','1403524','1403976','1407495','1407547','1465708','1465800','1465851','1466188','1466275','1466721','1466722','1469388','1470523','1470968','1471317','1472197','1472309','1472445','1476604','1477031','1477424','1523452','1526440','1526469','1526488','1526505','1526506','1526510','1526511','1526527','1526534','1530095','1534418','1537835','1539667','1539710','1539713','1539717','1539723','1539765','1539809','1540528','1540546','1540614','1540621','1541015','1541275','1541309','1541648','1541673','1541835','1541894','1542765','1543484','1544174','1544798','1544838','1545219','1545436','1546971','1547898','1547916','1548018','1548269','1550356','1550734','1557344','1557585','1557633','1559959','1559966','1559994','1560006','1560019','1565290','1565852','1566346','1575301','1579376','1579515','1579733','1579734','1580052','1581147','1581378','1604621','1608318','1608320','1611448','1612083','1612088','1613106','1613921','1617892','1618024','1618079','1618972','1618993','1620087','1620189','1620247','1620699','1621132','1622834','1622849','1623263','1623473','1623782','1623908','1625691','1625843','1626213','1627464','1627514','1628103','1628701','1629242','1630028','1631315','1631475','1631897','1631929','1632439','1632440','1633659','1637738','1646339','1646536','1651792','1652402','1652420','1652436','1653939','1653959','1654832','1654940','1661756','1662002','1669787','1670414','1670448','1670504','1671334','1671336','1671708','1671710','1671711','1672566','1672578','1672580','1676606','1677959','1680953','1682843','1685693','1686624','1692014','1692063','1694237','1694458','1694469','1694950','1695408','1696711','1696723','1697648','1699310','1701345','1702310','1702446','1702713','1702813','1703187','1703333','1703432','1703459','1703918','1704167','1704498','1704771','1705189','1705315','1705706','1705749','1706282','1707126','1707132','1708038','1708364','1709265','1709388','1709389','1713138','1719067','1721987','1722480','1722877','1727091','1727228','1727375','1727377','1727940','1728129','1747209','1747217','1747858','1750782','1753755','1756437','1756661','1756735','1760349','1767078','1767406','1767442','1767904','1768084','1772515','1772601','1773238','1773444','1773448','1773515','1773518','1773629','1773748','1774326','1774743','1775056','1775651','1778040','1778148','1778912','1779135','1779799','1780010','1780021','1780235','1780692','1780702','1781216','1781392','1781676','1781680','1781730','1782014','1782315','1782585','1782617','1782678')
         and stu.stateid = 36560 and en.activeflag is true and en.currentschoolyear = 2016 and ts.source = 'ITI' and st.status = (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='exitclearunenrolled' AND ct.typecode = 'STUDENT_TEST_STATUS') and st.activeflag is false);
--Update Count: 1590
         
--DE12555: EP: Production - Student has confirmed tests that have not been administered but they are not available in KITE Client         
update ititestsessionhistory set activeflag = false,
status=(SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='exitclearunenrolled' AND ct.typecode = 'STUDENT_TEST_STATUS'),
modifieddate = now(), modifieduser = (select id from aartuser where username = 'cetesysadmin')
where testsessionid in (select testsessionid from studentstests where status=477 and activeflag is false and testsessionid in(select id from testsession where source='ITI'))
and status != (SELECT c.id FROM category c,categorytype ct WHERE  c.categorytypeid = ct.id AND c.categorycode='exitclearunenrolled' AND ct.typecode = 'STUDENT_TEST_STATUS');         