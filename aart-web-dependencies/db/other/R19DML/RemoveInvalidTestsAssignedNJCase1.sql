DO $$DECLARE

STUDENTTRACKERBAND_ROW RECORD;
STUDENTTEST_ROW RECORD;
STUDENTTRACKER_ROW RECORD;
COUNT BIGINT;

BEGIN

COUNT:=0;

FOR STUDENTTRACKERBAND_ROW IN
select stb.* from studenttrackerband stb
inner join studenttracker st on st.id=stb.studenttrackerid
where stb.activeflag=true and st.activeflag=true
and stb.modifieddate>='2015-03-13'
and st.studentid in (
854075,
857190,
857192,
857876,
859414,
859456,
859853,
860440,
861883,
861885,
810185,
862016,
862017,
809586,
862018,
809587,
862019,
862085,
862107,
810189,
810188,
810186,
862112,
862114,
808098,
810191,
862195,
862196,
862197,
862198,
862198,
862199,
862200,
862200,
862201,
862202,
862203,
862204,
862205,
862206,
756614,
862207,
862232,
862430,
862431,
674962,
863757,
863862,
863863,
812035,
864734,
815582,
865606,
865702,
865983,
865985,
867934,
872948,
873007,
874043,
874212,
874212,
874213,
727696,
877423,
880323,
882349,
882363,
811532,
811531,
882370,
882420,
882437,
885123,
805139,
805141,
805145,
805148,
890997,
890998,
890999,
891000,
891542,
896575,
896579,
896580,
896581,
896582,
896583,
896584,
896587,
896589,
897163,
897165,
897172,
897174,
899401,
899818,
899867,
899872,
899872,
899876,
899876,
900038,
900682,
900683,
900684,
900685,
900686,
900687,
903861,
903862,
903866,
908536,
909323,
909325,
909327,
909329,
909330,
912048,
912049,
912050,
912051,
912052,
912053,
912054,
912526,
926803,
929809,
945545,
945800,
865832,
950961,
1006590,
1007382,
1034576,
1034599,
1034601,
1034603,
1034604,
1034605,
1034606,
1034607,
1034608,
1034609,
1034610,
1034614,
1034615,
1034618,
1034621,
1034622,
1034625,
1034626,
1034627,
1034628,
1034630,
1034632,
1034634,
1034637,
1034639,
1034640,
1034641,
1039359,
1039360,
1039362,
1043033,
1049947,
1052489,
1076931,
1081681,
858765,
1092028,
1092767,
1097853,
1097854,
1097855,
1097860,
1097861,
1097862,
1097864,
1097865,
1097872,
1097874,
1097876,
1097879,
1097884,
1097886,
1097891,
1097893,
1111221,
1111222,
1111223,
1111224,
1111225,
1111226,
1111227,
1111228,
1111229,
1111230,
1111231,
1124043,
1124044,
1124045,
1124187,
1124189,
1130964,
1124079,
1124079,
1133082,
1135045,
1135046,
1135075,
1135080,
1135083,
876872,
1145887,
1145888,
1145891)


LOOP

COUNT:=COUNT+1;
RAISE NOTICE 'Student Tracker Band Id, %',STUDENTTRACKERBAND_ROW.id;

IF STUDENTTRACKERBAND_ROW.testsessionid is not null THEN

update studentstestsections set activeflag=false where studentstestid in (select id from studentstests where testsessionid=STUDENTTRACKERBAND_ROW.testsessionid);
update studentstests set activeflag=false,status=494 where testsessionid=STUDENTTRACKERBAND_ROW.testsessionid;
update testsession set activeflag=false where id=STUDENTTRACKERBAND_ROW.testsessionid;

END IF;

update studenttrackerband set activeflag=false where id=STUDENTTRACKERBAND_ROW.id;
update studenttracker set status='UNTRACKED' where id=STUDENTTRACKERBAND_ROW.studenttrackerid;

END LOOP;

RAISE NOTICE 'Total Count, %',COUNT;

END$$;