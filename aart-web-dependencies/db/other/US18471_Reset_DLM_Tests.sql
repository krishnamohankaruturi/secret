-- US18471 : DLM TEST RESET

UPDATE studentsresponses SET activeflag = false, modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin'), modifieddate = now()
     WHERE studentstestsid IN (SELECT id FROM studentstests WHERE 
     testsessionid IN (2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,
     2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,
     2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041));

UPDATE studentstestsections SET activeflag = false,  modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin'), modifieddate = now()
      WHERE studentstestid IN (SELECT id FROM studentstests WHERE testsessionid IN (2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,
     2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,
     2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041));

UPDATE studentstests SET activeflag = false, modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin'), modifieddate = now()
     WHERE testsessionid IN (2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,
     2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,
     2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041);
                 
UPDATE testsession SET activeflag = false, modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin'), modifieddate = now()
     WHERE id IN (2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,
     2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,
     2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041 );

UPDATE studenttrackerband SET activeflag = false, modifieddate = now(), modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin')
     WHERE studenttrackerid in (144229,208582,208668,223558,223584,215278,195605,222015,207257,219250,207418,263568)
       AND testsessionid in (2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,
     2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,
     2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041 )
	AND source = 'ST';

 UPDATE studenttracker SET status = 'UNTRACKED', modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin'), modifieddate = now()  
 where id in (144229,208582,208668,223558,223584,215278,195605,222015,207257,219250,207418,263568); 


UPDATE studenttrackerband SET testsessionid = null, modifieddate = now(), modifieduser = (SELECT id FROM aartuser WHERE username = 'cetesysadmin')
     WHERE studenttrackerid IN (208582,208668,223558,223584,194900)
     AND testsessionid in (2355723,2355722,2358688,2358690,2360429)
     AND source = 'FC';

INSERT INTO domainaudithistory (source, objecttype, objectid, createduserid, createddate, action, objectbeforevalues, objectaftervalues)
      values('SCRIPT', 'STUDENTSTESTS', 1318084, 12, now(), 'RESET_STUDENT_TRACKER', ('{"TestSessionIds": "2838590,2863365,2896712,2949636,2718333,2732708,2735852,2775677,2777368,2717074,2718477,2773961,2777933,2829752,2923344,2903370,2848928,2836995,2692894,2848819,2835446,2736059,26928982691632,2437016,2482949,2510847,2523932,2527208,2729474,2865494,2970581,2569287,2677006,2645950,2593909,2702041,2355723,2355722,2358688,2358690,2360429", "activeflag": true}')::JSON,  
      ('{"Reason": "As per US18471, inactivated the students tests"}')::JSON);
